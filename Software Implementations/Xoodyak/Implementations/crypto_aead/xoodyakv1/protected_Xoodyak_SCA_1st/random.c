#include <stdio.h>
#include <stdint.h>
#include <string.h>
#include <stdlib.h>
#include "Xoodyak.c"
#include "encrypt.c"
#include "Xoodoo-reference.c"



int main() {
	
	int a, b, i;
	unsigned char c[48] = {};
	unsigned long long clen;
	const unsigned char m[32] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	unsigned long long mlen = 8;
	const unsigned char ad[32] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	unsigned long long adlen = 0;
	const unsigned char nsec[] = {};
	const unsigned char npub[16] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	const unsigned char k[16] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	
	unsigned char m1[32] = {};
	unsigned long long m1len;
	unsigned char nsec1[] = {};
	const unsigned char c1[48] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	unsigned long long c1len = 19;
	
	a = crypto_aead_encrypt(c, &clen, m, mlen, ad, adlen, NULL, npub, k);
	
	b = crypto_aead_decrypt(m1, &m1len, NULL, c, clen, ad, adlen, npub, k);
	
	for(i = 0; i < clen; i++)
	{
		printf("%02x",c[i]);
	}
	printf("\n");
	for(i = 0; i < m1len; i++)
	{
		printf("%02x",m1[i]);
	}
	printf("\n%d, %d", a, b);

	return 0;
}
